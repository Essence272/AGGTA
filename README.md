Introduction:
This AGGTA tool is used for attack graph generation and threat analysis of enterprise systems. This tool builds an automatic generation model of attack graphs specific to enterprise systems based on the meta-attack language (MAL) and CAPEC and ATT&CK Matrix data. This model integrates CAPEC and ATT&CK framework data to support high coverage of threats and enables the generation of attack graphs based on scene topology information. The tool also provides the ability of attack path inference and analysis, including the process of attack graph structure optimization, node evaluation, attack simulation and mitigation measure generation, which can generate attack paths sorted by risk degree and the corresponding mitigation measures.
The AGGTA tool is provided to support users in undertaking a complete threat modeling process for real-world scenarios, including attack graph generation, attack path inference, threat resolution, and validation of mitigation measures.
The tool help enterprise users generate attack graphs conveniently in the process of system security design and analysis, support high coverage of APT threats, and analyze and obtain a list of attack paths sorted according to the level of risk. It also provides users with more realistic attack simulation functions and user-friendly graphical interfaces, and provide mitigation measures, hypothesis analysis and other services. 
This helps users intuitively understand the process of attacks and make security decisions.


Included files:
The rule.mal file in the project is the summarized data, which integrates CAPEC and ATT&CK Matrix data.
The code.zip compressed package contains complete tool and data files and is a collection of all the files.
The test file contains data from AtomicRedTeam(https://atomicredteam.io/; https://github.com/redcanaryco/atomic-red-team), an open-source framework for adversary emulation and penetration testing.
Main.java: The source code file of the main program, which contains the main() method, is responsible for starting the tool.
Main.class: The bytecode file compiled by Java (generated by Main.java compilation) is the entry point of the program.
The .class file in the core/ directory: core engine code, core logic modules of the tool.
The dependence file contains the core Java dependency libraries:
commons-math3-3.6.1.jar: The Apache Commons Math library provides mathematical computing functions for probability calculation and path analysis.
jcommon-1.0.23.jar: A companion library for JFreeChart, used for chart rendering and data visualization.
Graphviz: A visualization tool used for generating graphical displays of attack graphs.


Tool running:
Environmental preparation:
Java environment: Install JDK 1.8+ (e.g., JDK 11)
Database: Install MySQL 5.7+

Dependent library: 
Make sure that the dependent JAR files (e.g., commons-math3-3.6.1.jar, jcommon-1.0.23.jar) are placed in the dependence directory or installed via Maven/Gradle. 
Graphviz installation： 
Linux: sudo apt-get install graphviz
macOS: brew install graphviz
Windows: Download the Graphviz installation package and add the installation path (e.g., C:\Program Files\Graphviz\bin) to the system PATH.

Run: 
# Method 1: Run the compiled Main.class directly
java -cp ".:lib/*" Main 
# Method 2: Recompile (run Main.java) 
javac -cp ".:lib/*" Main.java 
java -cp ".:lib/*" Main 
# Windows users replace ':' with ';'：
java -cp ".;lib\*" Main


Tool usage：
The usage process of the AGGTA attack graph threat modeling tool: First, users can choose the existing automatic generation model or extend the existing threat and attack transfer rules to complete the adjustments required by the scenario. Then, users can directly use the graphical node drag-and-drop interface to start building the system topology diagram of the real scene, or select the scenes that need to be edited from the existing scene list through the loading function of the scene management module to start building. After completing the system topology diagram, users can obtain modification suggestions for the current topology through the specification check function. After passing the specification check, users can load the attribute configuration for risk assessment on the node and conduct attack simulation to complete the analysis of the attack graph. Ultimately, the scene topology, the list of attack paths sorted based on occurrence probability, and the list of mitigation measures can be saved and exported.
Users can view and add/modify the transfer rules of the automatically generated model: On the home page, select the “Model Update” option; Enter the model viewing and editing interface; Find the code description of a certain asset (e.g., the system asset “OS”); Add/modify rules in the MAL code (e.g., “test1->test2”); Click the “Save and Update” button to save the updated content of the model and complete the update.
When the system scene input and construction are completed, click the “Attack Graph Generation” button on the toolbar, and a window will pop up to display the corresponding attack graph of the current system scene. When the “Attack Simulation” button on the toolbar is clicked, a pop-up window will appear at the bottom to display the list of attack paths corresponding to the attack graph. The list content includes the path number, penetration entry, attack target, path length and occurrence probability, and provides a graphical display of individual attack paths.
